<!DOCTYPE html>

<html>
<head>
    <meta charset="utf-8" />
    <title>Kniffel</title>
    <link rel="stylesheet" href="StyleSheets/styles.css" />
    <link rel="stylesheet" href="StyleSheets/NavbarStyle.css" />
    <link rel="stylesheet" href="StyleSheets/LoginStyle.css" />
</head>

<body>
    <!--Naviagtionsleiste oben-->
    <div class="navbar">
        <a href="Index.html">Startseite</a>
        <a class="active" href="Spiel.html">Spiel</a>
        <div class="dropdown">
            <button class="dropbtn">
                Optionen
                <i class="fa fa-caret-down"></i>
            </button>
            <div class="dropdown-content">
                <a href="Optionen.html">Ranking</a>
                <a href="Regeln.html">Regeln</a>
            </div>
        </div>
        <a href="Impressum.html">Impressum</a>
        <a href="Datenschutz.html">Datenschutz</a>
        <!-- Button to open the modal login form -->
        <button class="login" onclick="document.getElementById('id01').style.display='block'">Login</button>
    </div>

    <!-- Headline -->
    <h1>Auf dieser Seite wird das Spiel spielbar sein</h1>

    <!-- Würfel anzeige-->
    <div class="Dices">
        <img class="Dice" id="Dice1" src="Bilder/Würfelseiten/1eyed.jpg" onclick="auswählen(this)">
        <img class="Dice" id="Dice2" src="Bilder/Würfelseiten/1eyed.jpg" onclick="auswählen(this)">
        <img class="Dice" id="Dice3" src="Bilder/Würfelseiten/1eyed.jpg" onclick="auswählen(this)">
        <img class="Dice" id="Dice4" src="Bilder/Würfelseiten/1eyed.jpg" onclick="auswählen(this)">
        <img class="Dice" id="Dice5" src="Bilder/Würfelseiten/1eyed.jpg" onclick="auswählen(this)">
    </div>

    <!-- Knopf zum Wüfeln-->
    <center><button id="würfle" onclick="rollDice5()"> Würfle </button></center>

    <!--  wahrscheinlich nicht benötigt
    <p id="ergebnis1">0</p>
    <p id="ergebnis2">0</p>
    <p id="ergebnis3">0</p>
    <p id="ergebnis4">0</p>
    <p id="ergebnis5">0</p>
        -->

    <!-- Block, 
        erstes td = name der kombi mit onclick funktion zum punkte berechenen
        zweites td = speicher der Punkte 
        -->
    <table id="rheihe">
        <caption>Block</caption>
        <tr>
            <th>Kombi</th>
            <th>Spieler 1</th>
            <!-- <th>Spieler 2</th>
            <th>Spieler 3</th>
            <th>Spieler 4</th>
             -->
        </tr>
        <tr>
            <td onclick="obererBlock(1)">Einser</td>
            <td id="einserPunkte" onclick="obererBlock(1)"></td>
        </tr>
        <tr>
            <td onclick="obererBlock(2)">Zweier</td>
            <td id="zweierPunkte" onclick="obererBlock(2)"></td>
        </tr>
        <tr>
            <td onclick="obererBlock(3)">Dreier</td>
            <td id="dreierPunkte" onclick="obererBlock(3)"></td>
        </tr>
        <tr>
            <td onclick="obererBlock(4)">Vierer</td>
            <td id="viererPunkte" onclick="obererBlock(4)"></td>
        </tr>
        <tr>
            <td onclick="obererBlock(5)">Fünfer</td>
            <td id="fünferPunkte" onclick="obererBlock(5)"></td>
        </tr>
        <tr>
            <td onclick="obererBlock(6)">Sechser</td>
            <td id="sechserPunkte" onclick="obererBlock(6)"></td>
        </tr>
        <tr>
            <td>Summe oben</td>
            <td id="summePunkte"></td>
        </tr>
        <tr>
            <td>Bonus</td>
            <td id="bonusPunkte"></td>
        </tr>
        <tr>
            <td>Oben Gesammt</td>
            <td id="obenGesammtPunkte"></td>
        </tr>
        <tr>
            <td onclick="pasch(3)">Dreierpasch</td>
            <td id="dreierpaschPunkte"></td>
        </tr>
        <tr>
            <td onclick="pasch(4)">Viererpasch</td>
            <td id="viererpaschPunkte"></td>
        </tr>
        <tr>
            <td onclick=" fullHouse()">Fullhouse</td>
            <td id="fullhousePunkte"></td>
        </tr>
        <tr>
            <td>Kleine Straße</td>
            <td id="kleineStraßePunkte"></td>
        </tr>
        <tr>
            <td>Große Straße</td>
            <td id="großeStraßePunkte"></td>
        </tr>
        <tr>
            <td onclick="pasch(5)">Kniffel</td>
            <td id="knifflePunkte"></td>
        </tr>
        <tr>
            <td>Chance</td>
            <td id="bonusPunkte"></td>
        </tr>
        <tr>
            <td>Summe untern</td>
            <td id="bonusPunkte"></td>
        </tr>
        <tr>
            <td>Summe Gesamt</td>
            <td id="bonusPunkte"></td>
        </tr>
    </table>



    <script>

        //Id der Wertfelder, veraltet
        const erg = ['ergebnis1', 'ergebnis2', 'ergebnis3', 'ergebnis4', 'ergebnis5'];


        var würfelWert = [1, 1, 1, 1, 1];

        var punkteOben = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];

        var punkteGesetzt = false;

        //Id der Würfel Bilder
        const die = ['Dice1', 'Dice2', 'Dice3', 'Dice4', 'Dice5'];

        var gewählteWürfel = ["0", "1", "2", "3", "4"];

        // ob die würfel schon mal angeclickt wurden
        var würfelGewählt = [false, false, false, false, false];
        var zähler = 0;

        //wie viele würfe in der runde noch übrig sind
        var würfelzähler = 3;

        // gibt zufällige zahl zwischen 1 und 6 zurück
        function rollDice() {
            var x = 1 + Math.floor(Math.random() * 6);
            return x;
        }

        // führt rollDice() 5 mal aus , speichert die ergebnisse, führt diceSide() aus
        function rollDice5() {
            if (würfelzähler > 0) {
                for (let i = 0; i < 5; i++) {
                    if (würfelGewählt[i] == false) {
                        würfelWert[i] = rollDice();
                        diceSide(die[i], würfelWert[i]);
                    }
                    

                }
                würfelzähler = würfelzähler - 1;
                punkteGesetzt = false;
            }
            
            
        }

        //kriegt würfel und wert, ändert würfelbild passend zum wert
        function diceSide(Dice, Value) {

            switch (Value) {
                case 1:
                    document.getElementById(Dice).src = "Bilder/Würfelseiten/1eyed.jpg";
                    break;
                case 2:
                    document.getElementById(Dice).src = "Bilder/Würfelseiten/2eyed.jpg";
                    break;
                case 3:
                    document.getElementById(Dice).src = "Bilder/Würfelseiten/3eyed.jpg";
                    break;
                case 4:
                    document.getElementById(Dice).src = "Bilder/Würfelseiten/4eyed.jpg";
                    break;
                case 5:
                    document.getElementById(Dice).src = "Bilder/Würfelseiten/5eyed.jpg";
                    break;
                case 6:
                    document.getElementById(Dice).src = "Bilder/Würfelseiten/6eyed.jpg";
                    break;

            }

        }

        function auswählen(sender) {
            var ind = die.indexOf(sender.id);

            if (würfelGewählt[ind] == false) {

                
                document.getElementById(sender.id).style.opacity = 0.5;
                würfelGewählt[ind] = true;
            } else {
                
                document.getElementById(sender.id).style.opacity = 1;
                würfelGewählt[ind] = false;
            }
            
            

            
            //gewählteWürfel[zähler] = erg[ind];

           // document.getElementById(gewählteWürfel[zähler]).innerHTML = zähler;
           // zähler = zähler + 1;
        }

        function addiereBestimmteWürfel(Wert) {
            var punkte = 0;

            for (let i = 0; i < 5; i++) {
                if (würfelWert[i] == Wert) {
                    punkte = punkte + würfelWert[i];
                }
            }
            return punkte;
        }

        function addiereWürfel() {
            var punkte = 0;

            for (let i = 0; i < 5; i++) {
                    punkte = punkte + würfelWert[i];
                
            }
            return punkte;
        }

        //methode kriegt einen wert, zählt alle würfel mit dem wert zusammen
        //trägt diese dann in die richtige spalte ein
        function obererBlock(Wert) {
            if (punkteGesetzt == false) {

                var punkte = addiereBestimmteWürfel(Wert);

                //trägt abhängig vom Wert die punkte in eine Spalte ein
                switch (Wert) {
                    case 1:
                        tragePunkteEin("einserPunkte", punkte, Wert);
                        break;
                    case 2:
                        tragePunkteEin("zweierPunkte", punkte, Wert);
                        break;
                    case 3:
                        tragePunkteEin("dreierPunkte", punkte, Wert);
                        break;
                    case 4:
                        tragePunkteEin("viererPunkte", punkte, Wert);
                        break;
                    case 5:
                        tragePunkteEin("fünferPunkte", punkte, Wert);
                        break;
                    case 6:
                        tragePunkteEin("sechserPunkte", punkte, Wert);
                        break;
                }
                würfelzähler = 3;
                punkteGesetzt = true;

            }
            
        }

        //methode kriegt eine id und punkte und trägt die punkte dann in die passende spalte ein
        function tragePunkteEin(PunkteId, punkte, pIndex) {
            document.getElementById(PunkteId).innerHTML = punkte;
            punkteOben[pIndex - 1] = punkte;

            summeObenBerechnen();
            
            if (punkteOben[7] >= 63) {
                punkteOben[8] = 35;
                document.getElementById("bonusPunkte").innerHTML = punkteOben[8];
            }

            for (let i = 0; i < 5; i++) {
                if (würfelGewählt[i] == true) {
                    auswählen(document.getElementById(die[i]));
                }
            }
        }

        //berechnet die summe der punkte im oberenBlock
        function summeObenBerechnen() {
            var punkteSumme = 0;
            for (let i = 0; i < 6; i++) {
                punkteSumme = punkteSumme + punkteOben[i];
            }
            punkteOben[7] = punkteSumme;
            document.getElementById("summePunkte").innerHTML = punkteSumme;
        }

        function pasch(anzahl) {
            var kombi = kombination();

            for (let i = 0; i < 6; i++) {
                if (kombi[i] >= anzahl) {
                    switch (anzahl) {
                        case 3:
                            tragePunkteEin("dreierpaschPunkte", addiereWürfel(), 10);
                            break;
                        case 4:
                            tragePunkteEin("viererpaschPunkte", addiereWürfel(), 11);
                            break;
                        case 5:
                            tragePunkteEin("knifflePunkte", 50, 15);
                            break;

                    }
                }
            }

            document.getElementById("fullhousePunkte").innerHTML = kombi[2];
            document.getElementById("kleineStraßePunkte").innerHTML = kombi[3];
            document.getElementById("großeStraßePunkte").innerHTML = kombi[4];
        }

        function fullHouse() {
            var full = false;
            var house = false;
            var kombi = kombination();

            for (let i = 0; i < 6; i++) {
                if (kombi[i] == 2) {
                    full = true;
                }
                if (kombi[i] == 3) {
                    house = true;
                }
            }

            if (full == true & house == true) {
                tragePunkteEin("fullhousePunkte", 25, 12);
            } else {
                tragePunkteEin("fullhousePunkte", 0, 12);
            }
        }

        //gibt zurück wie häufig die augenanzahlen vorkommt
        function kombination() {
            var häufigkeit = [0, 0, 0, 0, 0, 0];

            for (let i = 0; i < 5; i++) {
                häufigkeit[würfelWert[i] - 1] = häufigkeit[würfelWert[i] - 1] + 1;
            }
            return häufigkeit;
        }

    </script>
</body>

</html>